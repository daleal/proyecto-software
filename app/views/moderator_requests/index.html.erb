<div class="inner">

  <header class="major">
    <h1><%= "Lista de solicitudes del curso #{@course.initials}: #{@course.name}" %></h1>
  </header>

  <div class="table-wrapper">

    <table class="alt">
      <thead>
        <tr>
          <th>Ramo</th>
          <th>Mensaje</th>
          <th>Fecha de creación</th>
          <th>Estado</th>
          <% if current_user.administrator? %>
            <th colspan="3"></th>
          <% else %>
            <th colspan="1"></th>
          <% end %>
        </tr>
      </thead>

      <tbody>
        <% @moderator_requests.each do |moderator_request| %>
          <tr>
            <td><%= moderator_request.course_id %></td>
            <td><%= moderator_request.content %></td>
            <td><%= moderator_request.created_at.strftime("%d/%m/%y: %H:%M:%S") %></td>
            <td><%= moderator_request.status %></td>
            <% if (current_user.administrator?) ||(@is_moderator && moderator_request.pending?) %>
              <td><%= link_to 'Actualizar estado', edit_moderator_request_path(moderator_request) %></td>
            <% end %>
            <% if (moderator_request.user_id == current_user.id) %>
              <td><%= link_to 'Cancelar', moderator_request, method: :delete, data: { confirm: '¿Estás seguro?' } %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>

  </div>

  <br>

  <%=
    if !current_user.administrator? && !@is_moderator
      link_to 'Crear nueva', new_course_moderator_request_path
    end
  %>

</div>
